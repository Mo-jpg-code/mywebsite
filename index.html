<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Enhanced Echo Show UI</title>
    <style>
        /* Reset and Basic Setup */
        :root {
            --alexa-bg: #0F0F0F; /* Slightly darker bg */
            --alexa-bg-lighter: #181818;
            --alexa-card-bg: #1E1E1E;
            --alexa-card-bg-hover: #282828;
            --alexa-text-primary: #f0f0f0;
            --alexa-text-secondary: #a0a0a0;
            --alexa-accent: #00AEEF; /* A vibrant Alexa blue */
            --alexa-accent-light: #5DD3F0;
            --alexa-red: #ff4c4c;
            --alexa-green: #4CAF50;
            --border-radius: 16px; /* Slightly more rounded */
            --font-family: 'Amazon Ember', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            --transition-speed: 0.35s;
            --transition-easing: cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        @font-face {
            font-family: 'Amazon Ember';
            src: url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIFont-amazonember_Rg-552172239._V2_.woff2') format('woff2'),
                 url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIFont-amazonember_Rg-552172239._V2_.woff') format('woff');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        html, body {
            width: 100%; height: 100%;
            overflow: hidden;
            background-color: #000;
            font-family: var(--font-family);
            color: var(--alexa-text-primary);
            -webkit-tap-highlight-color: transparent;
        }

        #echo-show-ui-wrapper { /* New wrapper for aspect ratio */
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #echo-show-ui {
            position: relative;
            width: 100%; /* Will be constrained by wrapper */
            height: 100%; /* Will be constrained by wrapper */
            max-width: calc(100vh * 9 / 16);
            max-height: calc(100vw * 16 / 9);
            background-color: var(--alexa-bg);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.6);
            border-radius: 20px; /* Optional: rounded corners for the device itself */
            opacity: 0; /* Initially hidden for startup animation */
            transition: opacity 0.5s ease-in;
        }
        #echo-show-ui.loaded { opacity: 1; }


        /* Startup Screen */
        #startup-screen {
            position: fixed; /* Covers everything initially */
            top: 50%; left: 50%;
            transform: translate(-50%, -50%); /* Center within the wrapper, not just UI frame */
            width:  calc(min(100vw, 100vh * 9 / 16)); /* Match UI frame size */
            height: calc(min(100vh, 100vw * 16 / 9));
            max-width: calc(100vh * 9 / 16);
            max-height: calc(100vw * 16 / 9);
            background-color: var(--alexa-bg);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 1;
            transition: opacity 0.7s ease-out 0.3s, transform 0.7s var(--transition-easing) 0.3s;
            border-radius: inherit; /* Match UI's border radius if any */
        }
        #startup-screen.hidden {
            opacity: 0;
            transform: translate(-50%, -50%) scale(1.1); /* Slight zoom out effect */
            pointer-events: none;
        }
        #startup-logo svg {
            width: 80px; height: 80px;
            color: var(--alexa-accent);
            animation: pulse-logo 2.5s infinite ease-in-out, rotate-logo 15s linear infinite;
        }
        #startup-text {
            margin-top: 25px;
            color: var(--alexa-text-secondary);
            font-size: 1.1em;
            opacity: 0;
            animation: fadeInElement 1s ease-in 0.5s forwards;
        }
        @keyframes pulse-logo {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.15); opacity: 1; }
        }
        @keyframes rotate-logo {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        @keyframes fadeInElement { to { opacity: 1; } }


        /* Status Bar */
        #status-bar {
            padding: 18px 22px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: rgba(0,0,0,0.15);
            font-size: 0.9em;
            flex-shrink: 0;
            position: relative; z-index: 10; /* Above screen content */
        }
        #status-bar #time { font-weight: 500; font-size:1.05em; }
        #status-bar #status-icons { display: flex; align-items: center; }
        #status-bar #status-icons svg {
            width: 22px; height: 22px;
            margin-left: 12px;
            fill: var(--alexa-text-secondary);
            opacity: 0.8;
        }
        #status-bar #dnd-icon { display: none; } /* Hidden by default */
        #status-bar #dnd-icon.active { display: inline-block; fill: var(--alexa-accent); }


        /* Main Content Area */
        #main-content {
            flex-grow: 1;
            position: relative;
            overflow: hidden;
        }
        .screen {
            position: absolute;
            top: 0; left: 0; right:0; bottom:0; /* Full coverage */
            width: 100%; height: 100%;
            background-color: var(--alexa-bg);
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--alexa-accent) var(--alexa-card-bg);
            /* Transition properties */
            transition: transform var(--transition-speed) var(--transition-easing), opacity calc(var(--transition-speed) * 0.8) ease-out;
            transform: translateX(100%); /* Default off-screen to the right */
            opacity: 0;
            display: none; /* Managed by JS initially */
        }
        .screen.active {
            transform: translateX(0);
            opacity: 1;
            display: block;
        }
        .screen::-webkit-scrollbar { width: 6px; }
        .screen::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
        .screen::-webkit-scrollbar-thumb { background: var(--alexa-accent); border-radius: 3px;}

        /* Home Screen Specifics */
        #home-screen {
            background: linear-gradient(170deg, var(--alexa-bg-lighter) 0%, var(--alexa-bg) 70%),
                        url('https://source.unsplash.com/random/400x800?abstract,dark,aurora,space') no-repeat center center;
            background-size: cover;
            position: relative;
        }
        #home-screen::before { /* Darkening overlay for text readability */
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0,0,0,0.4); z-index: 0;
        }
        #home-screen > * { position: relative; z-index: 1; }

        .greeting { font-size: 2em; margin-bottom: 25px; font-weight: 300; }
        .content-carousel {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            padding-bottom: 15px;
            margin: 0 -20px; /* Extend to screen edges */
            padding-left: 20px; padding-right: 20px; /* Restore padding for content */
            -webkit-overflow-scrolling: touch;
        }
        .content-carousel::-webkit-scrollbar { height: 8px; }
        .content-carousel::-webkit-scrollbar-track { background: transparent; }
        .content-carousel::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }

        .card {
            flex: 0 0 88%;
            min-width: 290px;
            height: 190px;
            background-color: var(--alexa-card-bg);
            border-radius: var(--border-radius);
            margin-right: 18px;
            padding: 20px;
            scroll-snap-align: start;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.03);
            transition: transform 0.25s ease-out, box-shadow 0.25s ease-out, background-color 0.2s ease;
        }
        .card:hover {
            transform: translateY(-5px) scale(1.01);
            box-shadow: 0 8px 25px rgba(0,0,0,0.35);
            background-color: var(--alexa-card-bg-hover);
        }
        .card:last-child { margin-right: 0; }
        .card h3 { font-size: 1.3em; margin-bottom: 10px; font-weight: 500; }
        .card p { font-size: 0.95em; color: var(--alexa-text-secondary); line-height: 1.5; }
        .card.suggestion-card { background: linear-gradient(135deg, #222, #1a1a1a); }
        .card.photo-card {
            background-image: url('https://source.unsplash.com/random/400x300?landscape,city');
            background-size: cover; background-position: center; color: white;
            text-shadow: 0 1px 4px rgba(0,0,0,0.7);
        }


        .section-title { font-size: 1.5em; margin-bottom: 18px; color: var(--alexa-text-primary); padding-top: 15px; font-weight: 400; }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 18px;
        }
        .grid-item {
            background-color: var(--alexa-card-bg);
            border-radius: var(--border-radius);
            padding: 18px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 110px;
            border: 1px solid rgba(255,255,255,0.03);
        }
        .grid-item:hover { background-color: var(--alexa-card-bg-hover); transform: scale(1.03); }
        .grid-item svg { width: 36px; height: 36px; fill: var(--alexa-accent); margin-bottom: 12px; }
        .grid-item span { font-size: 0.9em; color: var(--alexa-text-secondary); line-height: 1.3; }
        .grid-item.active-device { background-color: var(--alexa-accent); }
        .grid-item.active-device svg { fill: white; }
        .grid-item.active-device span { color: white; font-weight: 500; }

        /* Music Screen Enhancements */
        #music-screen .album-art {
            width: 75%; aspect-ratio: 1/1;
            background-color: var(--alexa-card-bg); margin: 0 auto 25px auto;
            border-radius: var(--border-radius);
            background-image: url('https://source.unsplash.com/random/400x400?music,abstract');
            background-size: cover; background-position: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }
        #music-screen .track-info h2 { font-size: 1.6em; margin-bottom: 8px; }
        #music-screen .track-info p { font-size: 1.05em; color: var(--alexa-text-secondary); }
        #music-screen .progress-bar-container {
            width: 80%; margin: 25px auto; height: 6px;
            background-color: var(--alexa-card-bg); border-radius: 3px; overflow: hidden;
        }
        #music-screen .progress-bar {
            width: 30%; /* Default progress */ height: 100%;
            background-color: var(--alexa-accent); border-radius: 3px;
            transition: width 0.5s linear; /* For simulated progress */
        }
        #music-screen .controls svg { width: 30px; height: 30px; }
        #music-screen .controls .play-pause svg { width: 52px; height: 52px; }

        /* Settings Screen */
        .settings-list .setting-item {
            background-color: var(--alexa-card-bg); padding: 18px;
            margin-bottom: 12px; border-radius: var(--border-radius);
            display: flex; justify-content: space-between; align-items: center; cursor: pointer;
        }
        .settings-list .setting-item:hover { background-color: var(--alexa-card-bg-hover); }


        /* Navigation Bar */
        #nav-bar {
            display: flex; justify-content: space-around;
            padding: 12px 0;
            background-color: rgba(25, 25, 25, 0.6); /* Semi-transparent */
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-top: 1px solid rgba(255,255,255,0.08);
            flex-shrink: 0; position: relative; z-index: 100;
        }
        .nav-item svg { width: 30px; height: 30px; margin-bottom: 5px; }
        .nav-item span { font-size: 0.8em; }
        .nav-item.active, .nav-item:hover { color: var(--alexa-accent-light); }
        .nav-item.active { background-color: rgba(0, 174, 239, 0.15); }

        /* Voice Interaction Overlay */
        #voice-overlay {
            /* ... (styles mostly same, adjust padding if nav bar height changed) ... */
            position: absolute; bottom: 0; left: 0; width: 100%;
            height: 40%; /* Increased slightly */
            background: linear-gradient(to top, rgba(18,18,18,1) 60%, rgba(18,18,18,0));
            display: none; flex-direction: column; align-items: center; justify-content: flex-end;
            padding-bottom: calc(70px + 35px); /* Approx Nav bar height + some padding */
            z-index: 1000;
        }
        #voice-overlay.active { display: flex; }
        #listening-indicator {
            width: 85px; height: 85px;
             /* ... (pulse animation same) ... */
        }
        #voice-text { font-size: 1.3em; min-height: 2.2em; }

        /* Mic Button */
        #mic-button-container {
            position: fixed;
            bottom: calc(70px + 20px); /* Adjusted for new nav bar approx height */
            left: 50%; transform: translateX(-50%); z-index: 150;
        }
        #mic-button {
            width: 60px; height: 60px; /* Slightly larger */
             /* ... (styles mostly same) ... */
        }

        /* ... existing toggle switch, other minor styles ... */
        .settings-list .setting-item .toggle-switch {
            width: 50px; height: 26px; background-color: #444; border-radius: 13px; position: relative; cursor: pointer;
        }
        .settings-list .setting-item .toggle-switch .knob {
            width: 22px; height: 22px; background-color: white; border-radius: 50%;
            position: absolute; top: 2px; left: 2px; transition: transform 0.2s ease;
        }
        .settings-list .setting-item .toggle-switch.active { background-color: var(--alexa-green); }
        .settings-list .setting-item .toggle-switch.active .knob { transform: translateX(24px); }
    </style>
</head>
<body>

    <div id="echo-show-ui-wrapper">
        <!-- Startup Screen -->
        <div id="startup-screen">
            <div id="startup-logo">
                <svg viewBox="0 0 60 60"> <!-- Simple Alexa-like circle logo -->
                    <circle cx="30" cy="30" r="22" stroke="currentColor" stroke-width="5" fill="none" opacity="0.3"/>
                    <path d="M30 8 A 22 22 0 0 1 30 52" stroke="currentColor" stroke-width="5" fill="none" stroke-linecap="round" />
                    <path d="M30 8 A 22 22 0 0 0 30 52" stroke="currentColor" stroke-width="5" fill="none" stroke-linecap="round" transform="rotate(120 30 30)" />
                    <path d="M30 8 A 22 22 0 0 1 30 52" stroke="currentColor" stroke-width="5" fill="none" stroke-linecap="round" transform="rotate(240 30 30)" />
                    <circle cx="30" cy="30" r="8" fill="currentColor"/>
                </svg>
            </div>
            <div id="startup-text">Alexa is starting...</div>
        </div>

        <div id="echo-show-ui">
            <!-- Status Bar -->
            <div id="status-bar">
                <div id="time">10:08 AM</div>
                <div id="status-icons">
                    <svg id="dnd-icon" viewBox="0 0 24 24"><path d="M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8 s8,3.59,8,8S16.41,20,12,20z M17,11H7v2h10V11z"/></svg> <!-- DND Icon -->
                    <svg id="wifi-icon" viewBox="0 0 24 24"><path d="M12 4.5C7.03 4.5 2.73 7.21.96 11.5l1.45 1.02C3.86 8.63 7.61 6.5 12 6.5s8.14 2.13 10.59 6.02l1.45-1.02 C21.27 7.21 16.97 4.5 12 4.5zM12 9.5c-2.79 0-5.32 1.25-7.07 3.23l1.45 1.02C7.68 12.29 9.72 11.5 12 11.5s4.32.79 5.62 2.25l1.45-1.02C17.32 10.75 14.79 9.5 12 9.5zM12 14.5c-1.04 0-1.97.42-2.66 1.04l2.66 3.21 2.66-3.21C13.97 14.92 13.04 14.5 12 14.5z"/></svg> <!-- Wifi Icon -->
                     <div id="weather">
                        <!-- Sun Icon SVG -->
                        <svg viewBox="0 0 24 24"><path d="M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5S14.76,7,12,7z M12,4c0.55,0,1-0.45,1-1V1c0-0.55-0.45-1-1-1S11,0.45,11,1v2 C11,3.55,11.45,4,12,4z M12,20c-0.55,0-1,0.45-1,1v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2C13,20.45,12.55,20,12,20z M4.93,6.34 c0.39-0.39,1.02-0.39,1.41,0l1.41,1.41c0.39,0.39,0.39,1.02,0,1.41s-1.02,0.39-1.41,0L4.93,7.76C4.54,7.37,4.54,6.73,4.93,6.34z M16.24,17.66c0.39-0.39,1.02-0.39,1.41,0l1.41,1.41c0.39,0.39,0.39,1.02,0,1.41s-1.02,0.39-1.41,0l-1.41-1.41 C15.85,18.68,15.85,18.05,16.24,17.66z M20,11h-2c-0.55,0-1,0.45-1,1s0.45,1,1,1h2c0.55,0,1-0.45,1-1S20.55,11,20,11z M4,11H2 c-0.55,0-1,0.45-1,1s0.45,1,1,1h2c0.55,0,1-0.45,1-1S4.55,11,4,11z M17.66,6.34c0.39,0.39,1.02,0.39,1.41,0l1.41-1.41 c0.39-0.39,0.39-1.02,0-1.41s-1.02-0.39-1.41,0l-1.41,1.41C18.05,4.54,17.37,4.54,17.66,6.34z M7.76,19.07 c-0.39,0.39-0.39,1.02,0,1.41l1.41,1.41c0.39,0.39,1.02,0.39,1.41,0s0.39-1.02,0-1.41l-1.41-1.41 C8.78,18.68,8.15,18.68,7.76,19.07z"/></svg>
                        <span style="margin-left:5px;">72°F</span>
                    </div>
                </div>
            </div>

            <!-- Main Content - Holds different screens -->
            <div id="main-content">
                <!-- Home Screen -->
                <div id="home-screen" class="screen"> <!-- Initially active, JS will manage this -->
                    <div class="greeting">Good morning!</div>
                    <div class="content-carousel">
                        <div class="card suggestion-card">
                            <h3>Try "Alexa, what's my Flash Briefing?"</h3>
                            <p>Catch up on news and more.</p>
                        </div>
                        <div class="card photo-card">
                            <h3>Last Weekend's Hike</h3>
                            <p>Beautiful mountain views.</p>
                        </div>
                        <div class="card suggestion-card">
                            <h3>"Alexa, play Today's Hits on Amazon Music"</h3>
                            <p>Get your day started with music.</p>
                        </div>
                         <div class="card news-card" style="background: linear-gradient(135deg, #303030 0%, #181818 100%);">
                            <h3>Tech Spotlight</h3>
                            <p>Exploring future of smart homes.</p>
                        </div>
                    </div>

                    <div class="section-title">Quick Controls</div>
                    <div class="grid-container">
                        <div class="grid-item" data-device="living-room-light" data-type="toggle">
                            <svg viewBox="0 0 24 24"><path d="M12 2C7.03 2 3 6.03 3 11c0 2.05.74 3.92 2 5.38V18c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.03c.58.18 1.2.3 1.84.34.1.23.24.44.37.66H10c-.55 0-1 .45-1 1s.45 1 1 1h4c.55 0 1-.45 1-1s-.45-1-1-1h-.21c.13-.22.27-.43.37-.66.64-.04 1.26-.16 1.84-.34V18c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.62c1.26-1.46 2-3.33 2-5.38C21 6.03 16.97 2 12 2zm0 12c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zM12 5c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                            <span>Living Room Light</span>
                        </div>
                        <div class="grid-item" data-device="thermostat" data-type="adjust">
                             <svg viewBox="0 0 24 24"><path d="M12 13a5 5 0 00-5-5h-.5a.5.5 0 00-.5.5v9a.5.5 0 00.5.5h.5a5 5 0 005-5zm-2-3a3 3 0 013 3 3 3 0 01-3 3H8.5V10H10zM15 3a2 2 0 012 2v14a2 2 0 01-2 2H9a2 2 0 01-2-2V5a2 2 0 012-2h6zm0 2H9v14h6V5zm4 .5a.5.5 0 00-.5-.5H18a2 2 0 00-2-2h-2a2 2 0 00-2 2H9.5a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h.09a3.99 3.99 0 013.82 3h.18a3.99 3.99 0 013.82-3H18.5a.5.5 0 00.5-.5v-1z"/></svg>
                            <span>Thermostat</span>
                        </div>
                    </div>
                </div>

                <!-- Music Screen -->
                <div id="music-screen" class="screen">
                    <div class="album-art"></div>
                    <div class="track-info" style="text-align: center; margin-bottom: 20px;">
                        <h2 id="music-title">Future Funk Beats</h2>
                        <p id="music-artist">Electro Voyager</p>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="music-progress"></div>
                    </div>
                    <div class="controls" style="display: flex; justify-content: space-around; align-items: center; padding: 0 20px;">
                        <button id="prev-track" aria-label="Previous Track" style="background:none; border:none; color:var(--alexa-text-primary); cursor:pointer;"><svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg></button>
                        <button id="play-pause-music" class="play-pause" aria-label="Play" style="background:none; border:none; color:var(--alexa-text-primary); cursor:pointer;">
                            <svg viewBox="0 0 24 24" id="play-icon"><path d="M8 5v14l11-7z"/></svg>
                            <svg viewBox="0 0 24 24" id="pause-icon" style="display:none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                        </button>
                        <button id="next-track" aria-label="Next Track" style="background:none; border:none; color:var(--alexa-text-primary); cursor:pointer;"><svg viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg></button>
                    </div>
                </div>

                <!-- Smart Home Screen -->
                <div id="smart-home-screen" class="screen">
                    <div class="section-title">All Devices</div>
                    <div class="grid-container">
                         <!-- Repeat device items similar to home screen or add more -->
                    </div>
                </div>

                <!-- Settings Screen -->
                <div id="settings-screen" class="screen">
                    <div class="section-title">General</div>
                    <div class="settings-list">
                        <div class="setting-item" data-action="toggle-dnd">
                            <span class="label">Do Not Disturb</span>
                            <div class="toggle-switch" data-setting="dnd">
                                <div class="knob"></div>
                            </div>
                        </div>
                         <div class="setting-item">
                            <span class="label">Wi-Fi</span>
                            <span class="value">Connected Network</span>
                        </div>
                    </div>
                     <div class="section-title">Display</div>
                     <div class="settings-list">
                         <div class="setting-item">
                            <span class="label">Brightness</span>
                            <input type="range" min="10" max="100" value="70" style="flex-grow:1; margin-left:20px; accent-color: var(--alexa-accent);">
                        </div>
                     </div>
                </div>
            </div>

            <!-- Voice Interaction Visual Cue -->
            <div id="voice-overlay"> /* Content same as before */ </div>

            <!-- Navigation Bar -->
            <div id="nav-bar">
                <a href="#" class="nav-item" data-screen="home-screen">
                    <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg><span>Home</span></a>
                <a href="#" class="nav-item" data-screen="music-screen">
                    <svg viewBox="0 0 24 24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6zm-2 16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg><span>Music</span></a>
                <a href="#" class="nav-item" data-screen="smart-home-screen">
                    <svg viewBox="0 0 24 24"><path d="M12 5.69l5 4.5V18h-2v-6H9v6H7v-7.81l5-4.5M12 3L2 12h3v8h14v-8h3L12 3z"/></svg><span>Smart Home</span></a>
                 <a href="#" class="nav-item" data-screen="settings-screen">
                    <svg viewBox="0 0 24 24"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42.12.64l2 3.46c.12.22.39.3.61.22l2.49 1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.79 3.5 3.5-1.57 3.5-3.5 3.5z"/></svg><span>Settings</span></a>
            </div>

            <!-- Floating Mic Button -->
            <div id="mic-button-container"> /* Content same as before */ </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const echoShowUI = document.getElementById('echo-show-ui');
        const startupScreen = document.getElementById('startup-screen');
        const timeEl = document.getElementById('time');
        const weatherTextEl = document.getElementById('weather').querySelector('span');
        const weatherIconEl = document.getElementById('weather').querySelector('svg');
        const screens = document.querySelectorAll('.screen');
        const navItems = document.querySelectorAll('.nav-item');
        const micButton = document.getElementById('mic-button'); // Assuming it exists from previous HTML
        const voiceOverlay = document.getElementById('voice-overlay'); // Assuming it exists
        const voiceText = document.getElementById('voice-text'); // Assuming it exists
        const dndIcon = document.getElementById('dnd-icon');
        const dndToggleSwitch = document.querySelector('.toggle-switch[data-setting="dnd"]');

        let currentScreenId = 'home-screen'; // Default active screen
        let voiceTimeout;
        let isDndActive = false;

        // --- Startup Animation ---
        setTimeout(() => {
            startupScreen.classList.add('hidden');
            echoShowUI.classList.add('loaded');
            startupScreen.addEventListener('transitionend', () => {
                startupScreen.style.display = 'none';
                // Initialize first screen display after startup
                showScreen(currentScreenId, 'none'); // 'none' for no animation on first load
            }, { once: true });
        }, 2800); // Total startup duration before UI appears

        // --- Clock & Weather Update ---
        function updateTime() {
            const now = new Date();
            timeEl.textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        // Mock Weather Data
        const weatherConditions = [
            { temp: '72°F', desc: 'Sunny', icon: '<svg viewBox="0 0 24 24"><path d="M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5S14.76,7,12,7z M12,4c0.55,0,1-0.45,1-1V1c0-0.55-0.45-1-1-1S11,0.45,11,1v2 C11,3.55,11.45,4,12,4z M12,20c-0.55,0-1,0.45-1,1v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2C13,20.45,12.55,20,12,20z M4.93,6.34 c0.39-0.39,1.02-0.39,1.41,0l1.41,1.41c0.39,0.39,0.39,1.02,0,1.41s-1.02,0.39-1.41,0L4.93,7.76C4.54,7.37,4.54,6.73,4.93,6.34z M16.24,17.66c0.39-0.39,1.02-0.39,1.41,0l1.41,1.41c0.39,0.39,0.39,1.02,0,1.41s-1.02,0.39-1.41,0l-1.41-1.41 C15.85,18.68,15.85,18.05,16.24,17.66z M20,11h-2c-0.55,0-1,0.45-1,1s0.45,1,1,1h2c0.55,0,1-0.45,1-1S20.55,11,20,11z M4,11H2 c-0.55,0-1,0.45-1,1s0.45,1,1,1h2c0.55,0,1-0.45,1-1S4.55,11,4,11z M17.66,6.34c0.39,0.39,1.02,0.39,1.41,0l1.41-1.41 c0.39-0.39,0.39-1.02,0-1.41s-1.02-0.39-1.41,0l-1.41,1.41C18.05,4.54,17.37,4.54,17.66,6.34z M7.76,19.07 c-0.39,0.39-0.39,1.02,0,1.41l1.41,1.41c0.39,0.39,1.02,0.39,1.41,0s0.39-1.02,0-1.41l-1.41-1.41 C8.78,18.68,8.15,18.68,7.76,19.07z"/></svg>' },
            { temp: '65°F', desc: 'Cloudy', icon: '<svg viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/></svg>' },
        ];
        function updateWeather() {
            const randomWeather = weatherConditions[Math.floor(Math.random() * weatherConditions.length)];
            weatherTextEl.textContent = randomWeather.temp;
            weatherIconEl.outerHTML = randomWeather.icon; // Replace the SVG element
        }
        updateTime(); updateWeather();
        setInterval(updateTime, 1000 * 30);
        // setInterval(updateWeather, 1000 * 60 * 15); // Update weather periodically

        // --- Screen Navigation (Improved) ---
        let isTransitioning = false;
        function showScreen(screenId, direction = 'forward') {
            if (isTransitioning && direction !== 'none') return;
            if (currentScreenId === screenId && direction !== 'none') return;

            isTransitioning = (direction !== 'none');

            const newScreen = document.getElementById(screenId);
            const currentActiveScreen = document.getElementById(currentScreenId);

            if (!newScreen) {
                console.error("Screen not found:", screenId);
                isTransitioning = false;
                return;
            }
            
            // Update Nav Bar
            navItems.forEach(item => item.classList.remove('active'));
            const activeNavItem = document.querySelector(`.nav-item[data-screen="${screenId}"]`);
            if (activeNavItem) activeNavItem.classList.add('active');

            if (currentActiveScreen && currentActiveScreen !== newScreen) {
                currentActiveScreen.classList.remove('active'); // Prepare for transition
                if (direction === 'forward') {
                    currentActiveScreen.style.transform = 'translateX(-100%)';
                } else if (direction === 'backward') {
                    currentActiveScreen.style.transform = 'translateX(100%)';
                }
                currentActiveScreen.style.opacity = '0';
                // Hide after transition
                currentActiveScreen.addEventListener('transitionend', function onTransitionEnd() {
                    this.style.display = 'none';
                    this.removeEventListener('transitionend', onTransitionEnd);
                }, { once: true });
            }
            
            newScreen.style.display = 'block'; // Make it visible before transition
            if (direction !== 'none') {
                newScreen.style.transform = direction === 'forward' ? 'translateX(100%)' : 'translateX(-100%)';
                newScreen.style.opacity = '0';
            } else { // For initial load or no animation
                 newScreen.style.transform = 'translateX(0%)';
                 newScreen.style.opacity = '1';
            }


            // Force a reflow to ensure the initial state is applied before transitioning
            newScreen.getBoundingClientRect();

            requestAnimationFrame(() => {
                newScreen.classList.add('active'); // This class defines transform: translateX(0) and opacity: 1
                // The actual transition to active state is handled by CSS class .active
                if (direction !== 'none') {
                    newScreen.style.transform = 'translateX(0)';
                    newScreen.style.opacity = '1';
                }
            });

            currentScreenId = screenId;

            if (direction !== 'none') {
                setTimeout(() => { isTransitioning = false; }, parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--transition-speed')) * 1000 + 50);
            } else {
                isTransitioning = false;
            }
        }

        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const targetScreenId = item.dataset.screen;
                if (targetScreenId === currentScreenId) return;

                let currentIndex = -1, targetIndex = -1;
                navItems.forEach((nav, idx) => {
                    if(nav.dataset.screen === currentScreenId) currentIndex = idx;
                    if(nav.dataset.screen === targetScreenId) targetIndex = idx;
                });
                const direction = targetIndex > currentIndex ? 'forward' : 'backward';
                showScreen(targetScreenId, direction);
            });
        });

        // --- Home Screen Carousel ---
        const carousel = document.querySelector('#home-screen .content-carousel');
        const carouselCards = carousel ? carousel.querySelectorAll('.card') : [];
        let currentCardIndex = 0;
        let carouselInterval;

        function scrollToCard(index) {
            if (carouselCards.length > 0 && carouselCards[index]) {
                carouselCards[index].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });
                currentCardIndex = index;
            }
        }
        function startCarousel() {
            if (!carousel) return;
            stopCarousel(); // Clear existing interval
            carouselInterval = setInterval(() => {
                let nextIndex = (currentCardIndex + 1) % carouselCards.length;
                scrollToCard(nextIndex);
            }, 6000);
        }
        function stopCarousel() { clearInterval(carouselInterval); }
        if (carousel) {
            carousel.addEventListener('mouseenter', stopCarousel);
            carousel.addEventListener('mouseleave', startCarousel);
            carousel.addEventListener('touchstart', stopCarousel, {passive: true});
            carousel.addEventListener('touchend', startCarousel);
            startCarousel();
        }


        // --- Music Player Simulation ---
        const playPauseMusicButton = document.getElementById('play-pause-music');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const musicProgressBar = document.getElementById('music-progress');
        let isPlayingMusic = false;
        let musicProgressInterval;

        function togglePlayPauseMusic(forcePlay) {
            if (typeof forcePlay === 'boolean') {
                isPlayingMusic = !forcePlay; 
            }
            isPlayingMusic = !isPlayingMusic;
            if (isPlayingMusic) {
                playIcon.style.display = 'none'; pauseIcon.style.display = 'block';
                playPauseMusicButton.setAttribute('aria-label', 'Pause');
                // Simulate progress
                clearInterval(musicProgressInterval);
                let currentProgress = parseFloat(musicProgressBar.style.width) || 0;
                if (currentProgress >= 100) currentProgress = 0; // Reset if at end
                musicProgressInterval = setInterval(() => {
                    currentProgress += 2; // Arbitrary increment
                    if (currentProgress > 100) currentProgress = 100;
                    musicProgressBar.style.width = currentProgress + '%';
                    if (currentProgress === 100) clearInterval(musicProgressInterval);
                }, 500);
            } else {
                playIcon.style.display = 'block'; pauseIcon.style.display = 'none';
                playPauseMusicButton.setAttribute('aria-label', 'Play');
                clearInterval(musicProgressInterval);
            }
        }
        if (playPauseMusicButton) playPauseMusicButton.addEventListener('click', () => togglePlayPauseMusic());
        // Add prev/next track logic if needed, resetting progress bar


        // --- DND Toggle ---
        function setDndState(active) {
            isDndActive = active;
            dndIcon.classList.toggle('active', isDndActive);
            if (dndToggleSwitch) dndToggleSwitch.classList.toggle('active', isDndActive);
            // Could also change overall UI like dimming screen slightly, etc.
            console.log("DND State:", isDndActive ? "ON" : "OFF");
        }
        if (dndToggleSwitch) {
            dndToggleSwitch.parentElement.addEventListener('click', () => setDndState(!isDndActive));
        }


        // --- Settings Toggles (Generic) ---
        document.querySelectorAll('.settings-list .toggle-switch:not([data-setting="dnd"])').forEach(toggle => {
            toggle.parentElement.addEventListener('click', () => { // Click on item for better UX
                toggle.classList.toggle('active');
                console.log(`Setting ${toggle.dataset.setting} toggled`);
            });
        });
        
        // --- Smart Home Device Toggling (Example) ---
        document.querySelectorAll('.grid-item[data-device]').forEach(item => {
            item.addEventListener('click', () => {
                // ... (existing logic for toggling, prompts, etc.)
                item.classList.toggle('active-device');
            });
        });

        // --- Voice Interaction (Simplified) ---
        if (micButton) {
            micButton.addEventListener('click', () => {
                if (voiceOverlay.classList.contains('active')) return;
                voiceOverlay.classList.add('active');
                voiceText.textContent = "Listening...";
                clearTimeout(voiceTimeout);
                voiceTimeout = setTimeout(() => {
                    const command = prompt("Alexa, I heard: (type your command)");
                    if (command) processVoiceCommand(command.toLowerCase());
                    else {
                        voiceText.textContent = "Sorry, I didn't catch that.";
                        setTimeout(() => voiceOverlay.classList.remove('active'), 2000);
                    }
                }, 1000);
            });
        }

        function processVoiceCommand(command) {
            let response = "Sorry, I can't do that yet.";
            if (command.includes("dnd on") || command.includes("do not disturb on")) {
                setDndState(true); response = "Okay, Do Not Disturb is now on.";
            } else if (command.includes("dnd off") || command.includes("do not disturb off")) {
                setDndState(false); response = "Okay, Do Not Disturb is off.";
            } else if (command.includes("time")) {
                response = `The time is ${timeEl.textContent}.`;
            } else if (command.includes("home")) {
                 showScreen('home-screen', 'backward');
                 response = "Okay.";
            }
            // ... other commands
            voiceText.textContent = response;
            setTimeout(() => voiceOverlay.classList.remove('active'), 3000);
        }
        
        // Fill smart home screen with some items for demo
        const smartHomeGrid = document.querySelector('#smart-home-screen .grid-container');
        if (smartHomeGrid) {
            const homeQuickControls = document.querySelector('#home-screen .grid-container');
            if (homeQuickControls) smartHomeGrid.innerHTML = homeQuickControls.innerHTML; // Copy from home
             const newDevice = document.createElement('div');
            newDevice.className = 'grid-item';
            newDevice.innerHTML = `<svg viewBox="0 0 24 24"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 11h-2v2h-2v-2H8V9h2V7h2v2h2v2z"/></svg><span>Fan Control</span>`;
            smartHomeGrid.appendChild(newDevice);
            // Re-attach event listeners if needed for newly added items, or use event delegation
        }


        // Default state for DND based on switch (if it's pre-set in HTML)
        if (dndToggleSwitch) setDndState(dndToggleSwitch.classList.contains('active'));


        // For voice overlay - make sure it's available if mic button is used
        if (!voiceOverlay && micButton) console.error("Voice overlay element not found!");
        if (!voiceText && micButton) console.error("Voice text element not found!");

    });
    </script>
</body>
</html>
