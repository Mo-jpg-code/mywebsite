<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>iPhone 15 Pro - Dynamic Island: Fluidly Pro</title>
    <style>
        :root {
            --bg-deep-space: #030305;
            --bg-interactive-element: #1C1C1E; /* For iPhone body */
            --text-luminous: #FFFFFF;
            --text-primary: #E8E8ED;
            --text-secondary: #9A9AA0;
            --accent-vibrant-blue: #0A84FF;
            --accent-highlight-glow: rgba(10, 132, 255, 0.2); /* Subtle glow for DI */
            
            /* Feature-specific accents (can be used for icons or subtle DI backgrounds) */
            --color-music: #FF2D55;
            --color-maps: #32D74B;
            --color-timer: #FF9500;
            --color-call: #5856D6;

            --screen-off-grey: #2C2C2E; /* Darker grey for even better DI contrast */
            --island-black: #000000;

            --font-ui-primary: "SF Pro Display", -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Arial, sans-serif;
            --font-ui-secondary: "SF Pro Text", -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Arial, sans-serif;

            --ease-apple-refined: cubic-bezier(0.45, 0, 0.15, 1); /* Very smooth, slightly faster start */
            --ease-spring-subtle: cubic-bezier(0.3, 1.2, 0.6, 1); /* Less aggressive spring */
            --ease-out-quint: cubic-bezier(0.23, 1, 0.32, 1);

            --td-scene: 0.9s; /* td: transition-duration */
            --td-island: 0.6s;
            --td-text: 0.75s;
        }

        /* Base & Global Styles */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html, body {
            width: 100%; height: 100%; overflow: hidden;
            background: var(--bg-deep-space);
            color: var(--text-primary);
            font-family: var(--font-ui-secondary);
            -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
            perspective: 1000px; /* For subtle 3D effects on stage if needed */
        }

        .animation-stage {
            width: 100%; height: 100%;
            position: relative; overflow: hidden;
            display: flex; justify-content: center; align-items: center; /* Center phone by default */
        }

        /* Contextual Background Accents */
        .background-accent-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden; z-index: 1; pointer-events: none;
        }
        .bg-blur-shape {
            position: absolute;
            border-radius: 50%;
            opacity: 0;
            transform: scale(0.5);
            transition: all 1.5s var(--ease-out-quint);
            filter: blur(80px); /* Significant blur for soft effect */
        }
        /* JS will position and color these based on scene */

        /* Scene Structure */
        .scene-content-wrapper { /* This holds text, absolutely positioned on stage */
            position: absolute;
            width: 100%; height: 100%;
            top:0; left:0;
            padding: 6vmin 4vmin;
            display: flex; /* For aligning text content */
            z-index: 100; /* Above phone, below certain UI popups if any */
            pointer-events: none; /* Allow clicks through to phone if it were interactive */
        }
        .text-group { /* Will contain title & description */
            opacity: 0;
            transform: translateY(25px);
            transition: opacity var(--td-text) var(--ease-apple-refined), transform var(--td-text) var(--ease-apple-refined);
            pointer-events: auto; /* Enable text selection if needed */
            will-change: opacity, transform;
        }
        .scene-content-wrapper.active .text-group { opacity: 1; transform: translateY(0); }

        .text-title {
            font-family: var(--font-ui-primary);
            font-size: clamp(5vmin, 7vw, 8vmin); font-weight: 600;
            line-height: 1.1; color: var(--text-luminous);
            margin-bottom: 1.8vmin;
            /* For character/word reveal */
            clip-path: inset(0 100% 0 0); transition: clip-path 0.8s var(--ease-out-quint) 0.1s;
        }
        .scene-content-wrapper.active .text-title { clip-path: inset(0 0% 0 0); }

        .text-description {
            font-size: clamp(3vmin, 4vw, 4.5vmin);
            color: var(--text-secondary); line-height: 1.45;
            max-width: 55vmin;
            /* For character/word reveal */
            clip-path: inset(0 100% 0 0); transition: clip-path 0.8s var(--ease-out-quint) 0.3s;
        }
        .scene-content-wrapper.active .text-description { clip-path: inset(0 0% 0 0); }
        
        /* iPhone Mockup - Cleaned and Refined */
        .iphone-rig { /* Handles global scale/opacity and subtle tilt */
            width: 40vmin; height: 80vmin;
            max-width: 190px; max-height: 380px; /* Slightly smaller for cleaner look */
            opacity: 0; transform: scale(0.9) rotateX(5deg); /* Initial subtle perspective */
            transition: opacity 1.2s var(--ease-out-quint) 0.2s, transform 1.2s var(--ease-out-quint) 0.2s;
            z-index: 50; position: relative; /* Centered by parent flex */
            will-change: opacity, transform;
        }
        .iphone-rig.visible { opacity: 1; transform: scale(1) rotateX(0deg); }

        .iphone-shell {
            width: 100%; height: 100%;
            background-color: var(--bg-interactive-element);
            border: 0.5vmin solid #38383A; /* Darker, more subtle border */
            border-radius: 7vmin; position: relative;
            box-shadow: 0 1vmin 2.5vmin rgba(0,0,0,0.35), inset 0 0 0.2vmin rgba(255,255,255,0.05);
        }
        .iphone-display {
            position: absolute; top: 1vmin; left: 1vmin;
            width: calc(100% - 2vmin); height: calc(100% - 2vmin);
            background-color: var(--screen-off-grey);
            border-radius: 6vmin;
            overflow: hidden; display: flex; flex-direction: column; align-items: center;
        }

        /* Dynamic Island - Enhanced Visuals */
        .di-host {
            margin-top: 3.5%; position: relative;
            width: 34%; min-width: 68px; height: 5.5%; min-height: 18px; /* Slightly larger for better presence */
        }
        .di-element {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            background-color: var(--island-black);
            border-radius: 2.8vmin;
            transition: width var(--td-island) var(--ease-spring-subtle),
                        height var(--td-island) var(--ease-spring-subtle),
                        border-radius var(--td-island) var(--ease-spring-subtle);
            display: flex; justify-content: space-between; align-items: center;
            padding: 1vmin 1.8vmin; /* Slightly more padding */
            overflow: hidden; color: var(--text-luminous);
            box-shadow: 0 0.1vmin 1vmin var(--accent-highlight-glow), /* Subtle outer glow */
                        inset 0 0.1vmin 0.1vmin rgba(255,255,255,0.05); /* Inner top highlight */
            will-change: width, height, border-radius;
        }
        .di-element.pill { width: 100%; height: 100%; }
        .di-element.expanded-m { width: 200%; height: 150%; border-radius: 4vmin; }
        .di-element.expanded-l { width: 280%; height: 220%; border-radius: 5vmin; }
        .di-element.banner {
            width: calc(var(--phone-screen-width-cssVar, 93%)); /* Using CSS var set by JS */
            height: 170%; border-radius: 4vmin;
        }

        .di-ui-content {
            opacity: 0; transform: translateY(2px) scale(0.98);
            transition: opacity 0.4s var(--ease-apple-refined) 0.15s, transform 0.4s var(--ease-apple-refined) 0.15s;
            font-size: max(2vmin, 11.5px); font-weight: 500;
            display: flex; align-items: center; gap: 1.3vmin;
            white-space: nowrap; width: 100%;
        }
        .di-element.active .di-ui-content { opacity: 1; transform: translateY(0) scale(1); }
        
        .di-ui-icon { width: 3.5vmin; height: 3.5vmin; min-width: 18px; min-height: 18px; }
        .di-ui-icon svg { display: block; width: 100%; height: 100%; fill: currentColor; }
        .di-ui-text-main { flex-grow: 1; text-align: left; }
        .di-ui-text-sub { font-size: 0.8em; color: var(--text-secondary); opacity: 0.9; }
        .di-ui-trailing { margin-left: auto; display: flex; align-items: center; }
        
        /* Enhanced DI Feature Styles */
        .di-feature-music .di-ui-icon { color: var(--color-music); }
        .di-feature-maps .di-ui-icon { color: var(--color-maps); }
        .di-feature-timer .di-ui-icon { color: var(--color-timer); }
        .di-feature-call .di-ui-icon { color: var(--color-call); }
        .di-call-avatar { width: 5vmin; height: 5vmin; border-radius: 50%; background-color: #444; margin-right: 1.3vmin; }
        .di-call-actions span { margin-left:1.5vmin; padding:0.7vmin; border-radius:50%; background:rgba(255,255,255,0.1); }
        .di-call-actions .hangup { background:rgba(255,45,85,0.2); color:#FF2D55; }
        .di-call-actions .answer { background:rgba(50,215,75,0.2); color:#32D74B; }

        .di-waveform-gfx { display: flex; align-items: flex-end; height: 3vmin; gap: 0.4vmin; }
        .di-waveform-gfx .gfx-bar { width: 0.5vmin; background-color: currentColor; /* Inherits color from parent */ border-radius: 0.25vmin; animation: diWaveGFX 1.2s infinite ease-in-out alternate; }
        .di-waveform-gfx .gfx-bar:nth-child(1) { height: 50%; animation-delay: -0.4s; }
        .di-waveform-gfx .gfx-bar:nth-child(2) { height: 90%; animation-delay: -0.2s; }
        .di-waveform-gfx .gfx-bar:nth-child(3) { height: 70%; animation-delay: 0s; }
        @keyframes diWaveGFX { 0% { transform: scaleY(0.2); } 100% { transform: scaleY(1); } }
    </style>
</head>
<body>
    <div class="animation-stage">
        <div class="background-accent-layer" id="bgAccentLayer">
            <!-- Blurred shapes added by JS -->
        </div>

        <div class="iphone-rig" id="iphoneRig">
            <div class="iphone-shell">
                <div class="iphone-display" id="iphoneDisplay">
                    <div class="di-host">
                        <div class="di-element pill" id="diElement"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="scene-content-wrapper" id="sceneContentWrapper">
            <div class="text-group" id="textGroup">
                <h1 class="text-title" id="mainTextTitle"></h1>
                <p class="text-description" id="mainTextDescription"></p>
            </div>
        </div>
    </div>

    <!-- SVG Icons (Same defs as before, ensure they are present) -->
    <svg width="0" height="0" style="position:absolute;visibility:hidden;">
        <defs>
            <g id="icon-music-note"> <path d="M12 3v10.55A4.003 4.003 0 0010 13a4 4 0 104 4V7h4V3h-6zm-2 12a2 2 0 110-4 2 2 0 010 4z"/> </g>
            <g id="icon-map-pin"> <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 010-5 2.5 2.5 0 010 5z"/> </g>
            <g id="icon-timer"> <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm-.25-13.55l-.24 1.7L15.5 12l-3.99 3.85.24 1.7L17.5 12l-5.75-5.55zM11 6v6h2V6h-2z"/> </g>
            <g id="icon-phone"> <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/> </g>
        </defs>
    </svg>

    <script>
    // --- Configurable Scene Data ---
    // textPos: alignSelf (flex start/center/end), textAlign (left/center/right)
    // iphonePos: { x, y } (percentage from center, e.g. x:-20 means 20% left of center)
    const MASTER_TIMELINE = [
        { name: 'Intro', duration: 3500, iphone: { visible: false }, text: { title: 'Dynamic Island', desc: 'A magical new way to interact with iPhone.', layout: { alignSelf: 'center', textAlign: 'center' } } },
        {
            name: 'Music', duration: 4800, iphone: { visible: true, x: 0, y: 10 }, // Phone slightly lower
            text: { title: 'Music in Motion', desc: 'Control playback, see album art, all fluidly integrated.', layout: { alignSelf: 'flex-start', textAlign: 'center' } }, // Text at top
            di: { initial: 'pill', sequence: [
                { state: 'expanded-m', delay: 400, content: makeMusicDI('Riverside', 'Agnes Obel') },
                { state: 'pill', delay: 3000, content: '' } ] }
        },
        {
            name: 'Maps', duration: 5200, iphone: { visible: true, x: -25, y: 0 }, // Phone left
            text: { title: 'Glanceable Navigation', desc: 'Your next turn, always in view. Arrive smoothly.', layout: { alignSelf: 'center', textAlign: 'left', customLeft: '55%' } }, // Text right
            di: { initial: 'pill', sequence: [
                { state: 'expanded-l', delay: 400, content: makeMapsDI('Turn left: Park Ave', '0.2 mi') },
                { state: 'pill', delay: 3500, content: '' } ] }
        },
        {
            name: 'Timer', duration: 4800, iphone: { visible: true, x: 25, y: 0 }, // Phone right
            text: { title: 'Live Activities', desc: 'Timers, sports scores, ride shares – all at a glance.', layout: { alignSelf: 'center', textAlign: 'right', customRight: '55%' } }, // Text left
            di: { initial: 'pill', sequence: [
                { state: 'expanded-m', delay: 400, content: makeTimerDI('Presentation', '14:52') },
                { state: 'pill', delay: 3000, content: '' } ] }
        },
        {
            name: 'Call', duration: 5500, iphone: { visible: true, x: 0, y: 0 }, // Phone centered
            text: { title: 'Calls, Reimagined', desc: 'Incoming calls transform the Island, keeping you in flow.', layout: { alignSelf: 'flex-end', textAlign: 'center', customBottom: '10%'} }, // Text bottom
            di: { initial: 'pill', sequence: [
                { state: 'banner', delay: 400, content: makeIncomingCallDI('Elena Royce', 'Mobile') },
                { state: 'expanded-l', delay: 1500, content: makeActiveCallDI('Elena Royce', '02:17') },
                { state: 'pill', delay: 2500, content: '' } ] }
        },
        { // Multitask (Simplified): Show two compact DI features sequentially for now
            name: 'Multitask', duration: 6000, iphone: { visible: true, x: 0, y: 10 },
            text: { title: 'Juggles It All', desc: 'Dynamic Island intelligently manages multiple background activities.', layout: { alignSelf: 'flex-start', textAlign: 'center' } },
            di: { initial: 'pill', sequence: [
                { state: 'expanded-m', delay: 400, content: makeMusicDI('Now Playing...', '', true) + makeTimerDI('Meeting', '05:10', true) }, // Both compact
                { state: 'pill', delay: 4000, content: '' } ] }
        },
        { name: 'Outro', duration: 4000, iphone: { visible: true, x:0, y:-5, finalScale: 1.03 }, text: { title: 'iPhone 15 Pro', desc: 'Fluidly Pro.', layout: { alignSelf: 'flex-end', textAlign: 'center', customBottom: '15%' } } }
    ];

    // --- Dynamic Island UI Content Generators ---
    function makeIcon(iconId, colorVar) { return `<span class="di-ui-icon" style="color:var(${colorVar});"><svg viewBox="0 0 24 24"><use href="#${iconId}"/></svg></span>`; }
    function makeMusicDI(title, artist, compact = false) {
        let html = `<div class="di-ui-content di-feature-music">${makeIcon('icon-music-note', '--color-music')}`;
        if (!compact) html += `<div class="di-ui-text-main">${title}<div class="di-ui-text-sub">${artist}</div></div>`;
        else html += `<div class="di-ui-text-main">${title}</div>`;
        html += `<div class="di-ui-trailing"><div class="di-waveform-gfx"><div class="gfx-bar"></div><div class="gfx-bar"></div><div class="gfx-bar"></div></div></div></div>`;
        return html;
    }
    function makeMapsDI(instruction, distance) {
        const arrowIcon = `<span class="di-ui-icon" style="transform: rotate(45deg);"><svg viewBox="0 0 24 24"><path d="M3 11l19-9L12.5 21.5 11 13 3 11z" fill="var(--color-maps)"/></svg></span>`;
        return `<div class="di-ui-content di-feature-maps">${makeIcon('icon-map-pin', '--color-maps')}<div class="di-ui-text-main">${instruction}<div class="di-ui-text-sub">${distance}</div></div><div class="di-ui-trailing">${arrowIcon}</div></div>`;
    }
    function makeTimerDI(label, time, compact = false) {
        let html = `<div class="di-ui-content di-feature-timer">${makeIcon('icon-timer', '--color-timer')}`;
        if (!compact) html += `<div class="di-ui-text-main">${label}</div>`;
        html += `<div class="di-ui-trailing" style="color:var(--color-timer); font-weight:600;">${time}</div></div>`;
        return html;
    }
    function makeIncomingCallDI(name, type) {
        const decline = `<span class="di-ui-icon hangup"><svg viewBox="0 0 24 24"><use href="#icon-phone" style="transform: rotate(135deg);"/></svg></span>`;
        const answer = `<span class="di-ui-icon answer"><svg viewBox="0 0 24 24"><use href="#icon-phone"/></svg></span>`;
        return `<div class="di-ui-content di-feature-call"><div class="di-call-avatar"></div><div class="di-ui-text-main">${name}<div class="di-ui-text-sub">${type}</div></div><div class="di-ui-trailing di-call-actions">${decline}${answer}</div></div>`;
    }
    function makeActiveCallDI(name, duration) {
        return `<div class="di-ui-content di-feature-call"><div class="di-call-avatar"></div><div class="di-ui-text-main">${name}<div class="di-ui-text-sub" style="color:var(--color-call);">${duration}</div></div><div class="di-ui-trailing"><div class="di-waveform-gfx" style="color:var(--color-call); height:2vmin;"><div class="gfx-bar"></div><div class="gfx-bar"></div><div class="gfx-bar"></div></div></div></div>`;
    }

    // --- Core Animation Logic ---
    let currentTimelineIndex = -1;
    let sceneTimer, diTimer;

    const iphoneRigEl = document.getElementById('iphoneRig');
    const diElementEl = document.getElementById('diElement');
    const iphoneDisplayEl = document.getElementById('iphoneDisplay');
    const sceneContentWrapperEl = document.getElementById('sceneContentWrapper');
    const textGroupEl = document.getElementById('textGroup');
    const mainTextTitleEl = document.getElementById('mainTextTitle');
    const mainTextDescriptionEl = document.getElementById('mainTextDescription');
    const bgAccentLayerEl = document.getElementById('bgAccentLayer');

    function updateDynamicIsland(stateClass, contentHTML = '') {
        clearTimeout(diTimer);
        diElementEl.className = 'di-element'; // Reset
        if (stateClass) diElementEl.classList.add(stateClass);
        diElementEl.innerHTML = contentHTML;

        if (stateClass === 'banner') {
            diElementEl.style.setProperty('--phone-screen-width-cssVar', `${iphoneDisplayEl.offsetWidth * 0.93}px`);
        } else {
            diElementEl.style.removeProperty('--phone-screen-width-cssVar');
        }
        // Trigger content animation
        setTimeout(() => { if (contentHTML) diElementEl.classList.add('active'); }, 20);
    }

    function playDISequence(sequence, initialShape) {
        updateDynamicIsland(initialShape, ''); // Start with initial shape, no content
        let stepIndex = 0;
        function nextStep() {
            if (stepIndex >= sequence.length) return;
            const step = sequence[stepIndex];
            diTimer = setTimeout(() => {
                updateDynamicIsland(step.state, step.content);
                stepIndex++;
                nextStep();
            }, step.delay);
        }
        nextStep();
    }

    function updateTextContent(config) {
        sceneContentWrapperEl.classList.remove('active'); // Hide old text
        
        if (config.text) {
            const layout = config.text.layout;
            sceneContentWrapperEl.style.alignItems = layout.alignSelf || 'center';
            textGroupEl.style.textAlign = layout.textAlign || 'center';
            
            // Handle custom positioning if provided
            textGroupEl.style.position = 'relative'; // Reset from potential absolute
            textGroupEl.style.left = 'auto'; textGroupEl.style.right = 'auto'; textGroupEl.style.bottom = 'auto';

            if (layout.customLeft) { textGroupEl.style.position = 'absolute'; textGroupEl.style.left = layout.customLeft; }
            if (layout.customRight) { textGroupEl.style.position = 'absolute'; textGroupEl.style.right = layout.customRight; }
            if (layout.customBottom) { textGroupEl.style.position = 'absolute'; textGroupEl.style.bottom = layout.customBottom; textGroupEl.style.top = 'auto';} // override flex align
            else {textGroupEl.style.top = 'auto';} // Reset top if not using customBottom

            mainTextTitleEl.innerHTML = config.text.title.split('').map(char => `<span>${char === ' ' ? ' ' : char}</span>`).join(''); // For char animation
            mainTextDescriptionEl.innerHTML = config.text.desc.split('').map(char => `<span>${char === ' ' ? ' ' : char}</span>`).join('');

            // Reveal new text - slightly delayed to allow old text to clear
            setTimeout(() => sceneContentWrapperEl.classList.add('active'), 100);
        }
    }
    
    function updateBackgroundAccents(sceneName) {
        bgAccentLayerEl.innerHTML = ''; // Clear old
        let shapes = [];
        switch(sceneName) {
            case 'Music': shapes.push({ size: '60vmin', color: 'var(--color-music)', top: '10%', left: '70%', opacity: 0.15 }); break;
            case 'Maps': shapes.push({ size: '70vmin', color: 'var(--color-maps)', top: '60%', left: '10%', opacity: 0.1 }); break;
            case 'Timer': shapes.push({ size: '50vmin', color: 'var(--color-timer)', top: '20%', left: '20%', opacity: 0.12 }); break;
            case 'Call': shapes.push({ size: '80vmin', color: 'var(--color-call)', top: '50%', left: '50%', opacity: 0.08 }); break;
        }
        shapes.forEach(s => {
            const shapeEl = document.createElement('div');
            shapeEl.className = 'bg-blur-shape';
            shapeEl.style.width = s.size; shapeEl.style.height = s.size;
            shapeEl.style.backgroundColor = s.color;
            shapeEl.style.top = s.top; shapeEl.style.left = s.left;
            bgAccentLayerEl.appendChild(shapeEl);
            setTimeout(() => { // Animate in
                shapeEl.style.opacity = s.opacity;
                shapeEl.style.transform = `scale(1) translate(-50%, -50%)`; // Assuming centered via top/left
            }, 100);
        });
    }


    function advanceTimeline() {
        clearTimeout(sceneTimer); clearTimeout(diTimer);

        currentTimelineIndex = (currentTimelineIndex + 1) % MASTER_TIMELINE.length;
        const config = MASTER_TIMELINE[currentTimelineIndex];

        // Update iPhone
        iphoneRigEl.classList.toggle('visible', config.iphone.visible !== false);
        if (config.iphone.visible) {
            const x = config.iphone.x || 0;
            const y = config.iphone.y || 0;
            const scale = config.iphone.finalScale || 1;
            iphoneRigEl.style.transform = `translate(${x}%, ${y}%) scale(${scale}) rotateX(0deg)`;
        }

        // Update Text
        updateTextContent(config);
        
        // Update Background Accents
        updateBackgroundAccents(config.name);

        // Update Dynamic Island
        if (config.di) {
            playDISequence(config.di.sequence, config.di.initial);
        } else {
            updateDynamicIsland('pill', ''); // Default state
        }

        sceneTimer = setTimeout(advanceTimeline, config.duration);
    }

    // --- Initial Setup ---
    window.onload = () => {
        // Initial hide for text elements for first animation
        sceneContentWrapperEl.classList.remove('active');
        advanceTimeline(); // Start the show
    };
    </script>
</body>
</html>
